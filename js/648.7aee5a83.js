"use strict";(globalThis["webpackChunkalarm_light_kittens"]=globalThis["webpackChunkalarm_light_kittens"]||[]).push([[648],{1648:(e,a,t)=>{t.r(a),t.d(a,{default:()=>R});t(939),t(7049),t(1746),t(4635);var l=t(1347),n=t(8633),o=t(7763),r=t(4187),s=t(4495),i=t.n(s);const u={class:"page-wrapper"},c={class:"container"},p={class:"main-grid"},m={class:"form-section"},d={class:"form-content"},v={class:"form-group"},k={class:"form-grid"},g={class:"form-group"},f={class:"form-group"},h={class:"form-group"},b={class:"button-group"},L=["disabled"],y={class:"marker-list-container"},w={class:"marker-list-title"},x={class:"marker-list-count"},N={class:"marker-list"},C={key:0,class:"empty-state"},_=["onClick"],S={class:"marker-name"},F={class:"marker-coords"},T="longan_geocode_cache",M={__name:"IndexPage",setup(e){const a=(0,r.KR)(""),t=(0,r.KR)(""),s=(0,r.KR)(""),M=(0,r.KR)(""),K=(0,r.KR)(!1),P=(0,r.KR)(null),R=(0,r.KR)(null),j=(0,r.Kh)({}),G=(0,l.EW)(()=>Object.keys(j).sort().map(e=>({name:e,lat:j[e].lat,lng:j[e].lng,marker:j[e].marker}))),O=i().icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",shadowSize:[41,41]}),V=[{name:"อาคารที่ 1",lat:18.758769,lng:99.014645},{name:"อาคารที่ 2",lat:18.758914,lng:99.015257},{name:"อาคารที่ 3",lat:18.758361,lng:99.015129},{name:"อาคารที่ 4",lat:18.757983,lng:99.015512},{name:"อาคารที่ 5",lat:18.758168,lng:99.015763},{name:"อาคารที่ 6",lat:18.757394,lng:99.015381},{name:"อาคารที่ 7",lat:18.75759,lng:99.015905},{name:"สนามฟุตซอล",lat:18.757955,lng:99.015097},{name:"สนามหญ้าจริง (safe zone)",lat:18.757826,lng:99.014679},{name:"สนามบาสเก็ดบอล",lat:18.757833,lng:99.015761}];function E(){P.value=i().map("map").setView([18.8,99],8),i().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(P.value),R.value=i().layerGroup().addTo(P.value),V.forEach(e=>{I(e.name,e.lat,e.lng,!1)})}function I(e,a,t,l=!1){if(!e||isNaN(a)||isNaN(t))return;const n=e.trim();if(j[n]){const e=j[n].marker;e.setLatLng([a,t]),e.setPopupContent(U(n,a,t)),j[n].lat=a,j[n].lng=t}else{const e=i().marker([a,t],{icon:O}).addTo(R.value);e.bindPopup(U(n,a,t)),e.on("click",()=>{e.openPopup()}),j[n]={lat:a,lng:t,marker:(0,r.IG)(e)}}J(),l&&P.value&&(P.value.flyTo([a,t],17,{duration:.8}),j[n]&&j[n].marker&&setTimeout(()=>{j[n].marker.openPopup()},800))}function U(e,a,t){return`<div>\n             <div class="font-semibold text-sm mb-1">${e}</div>\n             <div class="text-[11px] text-slate-500">\n               Lat: ${a.toFixed(6)}<br>Lng: ${t.toFixed(6)}\n             </div>\n           </div>`}function J(){const e=Object.values(j);if(0===e.length||!P.value)return;const a=i().featureGroup(e.map(e=>e.marker));1===e.length?P.value.setView(a.getBounds().getCenter(),17):P.value.fitBounds(a.getBounds().pad(.2))}function z(){a.value&&""!==t.value&&""!==s.value?I(a.value,Number(t.value),Number(s.value),!0):alert("กรุณากรอกชื่อสถานที่ และ Latitude/Longitude ให้ครบถ้วน")}function A(){a.value="",t.value="",s.value="",M.value=""}function B(e){P.value&&(P.value.flyTo([e.lat,e.lng],17,{duration:.7}),e.marker&&e.marker.openPopup())}async function X(){const e=M.value.trim();if(e){K.value=!0;try{const a=await W(e);a?(t.value=Number(a.lat.toFixed(6)),s.value=Number(a.lng.toFixed(6)),P.value&&P.value.flyTo([a.lat,a.lng],15,{duration:.8})):alert("ไม่พบพิกัดจากที่อยู่นี้ (Nominatim)")}catch(e){console.error(e),alert("เกิดข้อผิดพลาดในการเรียก Geocoding")}finally{K.value=!1}}else alert("กรุณากรอกที่อยู่สำหรับ Geocoding")}async function W(e){let a={};try{const e=localStorage.getItem(T);e&&(a=JSON.parse(e)||{})}catch(e){a={}}if(a[e])return a[e];const t="https://nominatim.openstreetmap.org/search?format=jsonv2&limit=1&q="+encodeURIComponent(e),l=await fetch(t,{headers:{Accept:"application/json"}});if(!l.ok)throw new Error("Geocoding error");const n=await l.json();if(!n||0===n.length)return null;const o=parseFloat(n[0].lat),r=parseFloat(n[0].lon);a[e]={lat:o,lng:r};try{localStorage.setItem(T,JSON.stringify(a))}catch(e){}return{lat:o,lng:r}}return(0,l.sV)(()=>{E()}),(e,r)=>((0,l.uX)(),(0,l.CE)("div",u,[(0,l.Lk)("div",c,[r[13]||(r[13]=(0,l.Lk)("h1",null,"แผนที่ระบุตำแหน่งอาคาร (Northern Thailand)",-1)),r[14]||(r[14]=(0,l.Lk)("p",{class:"subtitle"},"โรงเรียนวารีเชียงใหม่ - การศึกษาเพื่ออนาคตก้าวไกล",-1)),(0,l.Lk)("div",p,[(0,l.Lk)("section",m,[r[10]||(r[10]=(0,l.Lk)("h2",{class:"form-title"},[(0,l.Lk)("span",{class:"title-badge"},"1"),(0,l.eW)(" ฟอร์มบันทึกตำแหน่งอาคาร (Marker Form) ")],-1)),(0,l.Lk)("div",d,[(0,l.Lk)("div",v,[r[4]||(r[4]=(0,l.Lk)("label",null,"ชื่อสถานที่ / อาคาร (Building-Place)",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":r[0]||(r[0]=e=>a.value=e),type:"text",class:"form-input",placeholder:"เช่น อาคารที่ 1, futsal, สนามหญ้าจริง"},null,512),[[n.Jo,a.value]])]),(0,l.Lk)("div",k,[(0,l.Lk)("div",g,[r[5]||(r[5]=(0,l.Lk)("label",null,"Latitude",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":r[1]||(r[1]=e=>t.value=e),type:"number",step:"0.000001",class:"form-input",placeholder:"18.758769"},null,512),[[n.Jo,t.value,void 0,{number:!0}]])]),(0,l.Lk)("div",f,[r[6]||(r[6]=(0,l.Lk)("label",null,"Longitude",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":r[2]||(r[2]=e=>s.value=e),type:"number",step:"0.000001",class:"form-input",placeholder:"99.014645"},null,512),[[n.Jo,s.value,void 0,{number:!0}]])])]),(0,l.Lk)("div",h,[r[7]||(r[7]=(0,l.Lk)("label",null,"ที่อยู่ / สถานที่ (ใช้ Geocoding – Nominatim)",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":r[3]||(r[3]=e=>M.value=e),type:"text",class:"form-input",placeholder:"เช่น โรงเรียนวารี จังหวัดเชียงใหม่",onKeyup:(0,n.jR)(X,["enter"])},null,544),[[n.Jo,M.value]]),r[8]||(r[8]=(0,l.Lk)("p",{class:"form-hint"}," ระบบจะเรียกใช้บริการ Nominatim (OpenStreetMap) และแคชพิกัดไว้ใน Local Storage ",-1))]),(0,l.Lk)("div",b,[(0,l.Lk)("button",{onClick:X,disabled:K.value,class:"btn btn-primary"},(0,o.v_)(K.value?"กำลังค้นหาพิกัด...":"ค้นหา Lat/Lng"),9,L),(0,l.Lk)("button",{onClick:z,class:"btn btn-success"}," เพิ่ม / อัปเดต Marker "),(0,l.Lk)("button",{onClick:A,class:"btn btn-secondary"}," ล้างฟอร์ม ")])]),r[11]||(r[11]=(0,l.Lk)("hr",{class:"divider"},null,-1)),(0,l.Lk)("div",y,[(0,l.Lk)("h3",w,[r[9]||(r[9]=(0,l.eW)(" รายการ Marker ที่มีอยู่ ",-1)),(0,l.Lk)("span",x,"("+(0,o.v_)(G.value.length)+")",1)]),(0,l.Lk)("ul",N,[0===G.value.length?((0,l.uX)(),(0,l.CE)("li",C," ยังไม่มี Marker กรุณาเพิ่มจากฟอร์ม ")):((0,l.uX)(!0),(0,l.CE)(l.FK,{key:1},(0,l.pI)(G.value,e=>((0,l.uX)(),(0,l.CE)("li",{key:e.name},[(0,l.Lk)("button",{onClick:a=>B(e),class:"marker-item"},[(0,l.Lk)("span",S,(0,o.v_)(e.name),1),(0,l.Lk)("span",F,(0,o.v_)(e.lat.toFixed(4))+", "+(0,o.v_)(e.lng.toFixed(4)),1)],8,_)]))),128))])])]),r[12]||(r[12]=(0,l.Fv)('<section class="map-section" data-v-73d513ef><h2 class="form-title" data-v-73d513ef><span class="title-badge" data-v-73d513ef>2</span> แผนที่ฐาน (Map base) – Leaflet + OpenStreetMap </h2><p class="map-description" data-v-73d513ef> • Focus on Northern Thailand, zoom เริ่มต้นที่ 8<br data-v-73d513ef> • Marker สีเขียว (Green icon) หลายจุด จากข้อมูลในฟอร์ม<br data-v-73d513ef> • คลิก Marker เพื่อดูข้อมูลอาคาร (Pop-up) ที่อัปเดตตามข้อมูลล่าสุด </p><div id="map" class="map-container" data-v-73d513ef></div></section>',1))]),r[15]||(r[15]=(0,l.Lk)("footer",{class:"footer"}," Program by Vue.js | TailwindCSS | Leaflet.js | OpenStreetMap | Nominatim ",-1))])]))}};var K=t(2968);const P=(0,K.A)(M,[["__scopeId","data-v-73d513ef"]]),R=P}}]);