"use strict";(globalThis["webpackChunkalarm_light_kittens"]=globalThis["webpackChunkalarm_light_kittens"]||[]).push([[648],{1648:(e,a,n)=>{n.r(a),n.d(a,{default:()=>re});n(939),n(4520),n(7049),n(1746),n(4635);var t=n(1347),l=n(7763),o=n(4187),i=n(8633),r=n(4495),s=n.n(r),c=n(3022),u=n(6568),d=n(6575);const m={class:"row justify-center"},p={class:"col-12 col-xl-10"},g={class:"column q-gutter-lg"},v={class:"text-h6 text-primary flex items-center"},f={class:"text-h6 text-primary flex items-center q-mb-md"},b={class:"q-gutter-y-md"},y={class:"row q-col-gutter-sm"},k={class:"col-12 col-sm-6"},h={class:"col-12 col-sm-6"},x={class:"row items-center q-px-sm border-grey-1 rounded-borders bg-white q-py-xs"},w={class:"row q-col-gutter-sm q-mt-md"},q={class:"col-12 col-sm-auto"},F={class:"col-12 col-sm-auto"},_={class:"col-12 col-sm-auto"},L={class:"row items-center q-mb-sm"},S={class:"text-subtitle2 text-grey-8"},A={class:"row q-gutter-xs justify-end no-wrap"},C={class:"col-12"},V={class:"row items-start"},z={class:"col"},R={class:"text-subtitle1 text-weight-bold"},Z={class:"text-caption text-grey-7 q-mt-xs"},T={class:"col-auto"},N="longan_geocode_cache",Q={__name:"IndexPage",setup(e){const a=(0,c.A)(),n=(0,o.KR)(""),r=(0,o.KR)(null),Q=(0,o.KR)(null),W=(0,o.KR)(!1),K=(0,o.KR)(""),B=(0,o.KR)(!1),U=(0,o.KR)(!1),j=(0,o.KR)(!1),E=(0,o.KR)(""),I=(0,o.KR)(""),P=(0,o.KR)(!1),$=(0,o.KR)(null),O=(0,o.KR)(null),G=(0,o.KR)(null),M=(0,o.Kh)({}),X=d.Tg,D={center:[18.8,99],zoom:8},J=(0,t.EW)(()=>a.screen.lt.md),H=(0,t.EW)(()=>J.value?"q-pa-sm":"q-pa-md"),Y=(0,t.EW)(()=>a.screen.xs?"42vh":a.screen.sm?"48vh":a.screen.md?"520px":"640px"),ee=(0,t.EW)(()=>J.value?"width: 95vw; max-width: 95vw; border-radius: 12px; overflow: hidden;":"min-width: 420px; max-width: 520px; border-radius: 12px; overflow: hidden;"),ae=(0,t.EW)(()=>J.value?["name","isSafeZone","actions"]:["name","lat","lng","isSafeZone","actions"]);function ne(e){return String(e||"").trim()}function te(e){const a=Number(e);return Number.isFinite(a)?a:NaN}function le(e){if(!0===e||1===e||"1"===e)return!0;if(!1===e||0===e||"0"===e)return!1;if("string"===typeof e){const a=e.trim().toLowerCase();if("true"===a||"yes"===a||"y"===a)return!0;if("false"===a||"no"===a||"n"===a)return!1}return!!e}function oe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function ie(e){const a=te(e);return Number.isFinite(a)?a.toFixed(5):"-"}function re(e,a=150){let n=null;return(...t)=>{clearTimeout(n),n=setTimeout(()=>e(...t),a)}}const se=(0,t.EW)(()=>Object.keys(M).sort().map(e=>({name:e,lat:M[e].lat,lng:M[e].lng,isSafeZone:!!M[e].isSafeZone,marker:M[e].marker}))),ce=[{name:"name",label:"ชื่อสถานที่",field:"name",align:"left",sortable:!0},{name:"lat",label:"Latitude",field:"lat",align:"left",format:ie},{name:"lng",label:"Longitude",field:"lng",align:"left",format:ie},{name:"isSafeZone",label:"สถานะ Safe Zone",field:"isSafeZone",align:"center",sortable:!0},{name:"actions",label:"จัดการ",align:"right"}],ue=s().icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",shadowSize:[41,41]}),de=s().icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",shadowSize:[41,41]}),me=(0,o.KR)({type:"bounds",payload:null});function pe(){return a.screen.xs||a.screen.sm?16:17}function ge(){return a.screen.xs?24:a.screen.sm?34:a.screen.md?46:60}function ve(){return a.screen.xs?120:a.screen.sm?95:75}function fe(e,a=pe(),n=null,t={animate:!0}){if(!O.value)return;const l=Array.isArray(e)?s().latLng(e[0],e[1]):e;t.animate?(O.value.flyTo(l,a,{duration:.7}),setTimeout(()=>{O.value&&(n&&n.openPopup(),O.value.panBy([0,-ve()],{animate:!0}))},750)):(O.value.setView(l,a,{animate:!1}),n&&n.openPopup(),O.value.panBy([0,-ve()],{animate:!1})),me.value={type:"point",payload:{latlng:l}}}function be(e,a={animate:!0}){if(!O.value)return;const n=ge();O.value.fitBounds(e,{paddingTopLeft:[n,n],paddingBottomRight:[n,n],animate:!!a.animate}),me.value={type:"bounds",payload:{bounds:e}}}function ye(){O.value&&me.value?.payload&&("point"===me.value.type?fe(me.value.payload.latlng,pe(),null,{animate:!1}):"bounds"===me.value.type&&me.value.payload?.bounds&&be(me.value.payload.bounds,{animate:!1}))}function ke(){O.value&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{try{O.value?.invalidateSize({animate:!1})}catch{}})})}const he=re(({width:e,height:a})=>{O.value&&e&&a&&(ke(),setTimeout(()=>ye(),60))},120);function xe(){if(O.value){try{O.value.off(),O.value.remove()}catch{}O.value=null,G.value=null}}function we(){try{G.value?.clearLayers()}catch{}for(const e of Object.keys(M))delete M[e]}async function qe(){const e=await u.api.get("/api/markers");return Array.isArray(e.data)?e.data:[]}async function Fe(){U.value=!0;try{const e=await qe();if(!O.value)return;we(),e.length>0?e.forEach(e=>{const a=ne(e.name),n=te(e.lat),t=te(e.lng),l=le(e.isSafeZone);Se(a,n,t,l,!1,!1)}):X.forEach(e=>Se(e.name,e.lat,e.lng,!1,!1,!1))}catch(e){console.error("Failed to fetch markers:",e),we(),X.forEach(e=>Se(e.name,e.lat,e.lng,!1,!1,!1)),a.notify({color:"warning",message:"โหลดข้อมูลจากฐานข้อมูลไม่สำเร็จ ใช้ค่าเริ่มต้นแทน",icon:"warning"})}finally{U.value=!1,setTimeout(()=>{ke(),Ce()},80)}}async function _e(){O.value&&xe(),O.value=(0,o.IG)(s().map($.value).setView(D.center,D.zoom)),s().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(O.value),G.value=(0,o.IG)(s().layerGroup()).addTo(O.value),O.value.on("click",e=>{r.value=Number(e.latlng.lat.toFixed(6)),Q.value=Number(e.latlng.lng.toFixed(6)),a.notify({color:"info",message:`เลือกพิกัด: ${r.value}, ${Q.value}`,icon:"add_location",timeout:1500,position:"bottom-right"})}),ke(),await Fe()}async function Le(){if(!O.value)return _e();await Fe(),ke()}function Se(e,a,n,t=!1,l=!1,i=!0){const r=ne(e),c=te(a),u=te(n);if(!r||!Number.isFinite(c)||!Number.isFinite(u)||!G.value)return;const d=le(t),m=d?de:ue;if(M[r]){const e=M[r].marker;e.setLatLng([c,u]),e.setIcon(m),e.setPopupContent(Ae(r,c,u,d)),M[r].lat=c,M[r].lng=u,M[r].isSafeZone=d}else{const e=s().marker([c,u],{icon:m}).addTo(G.value);e.bindPopup(Ae(r,c,u,d)),e.on("popupopen",e=>{const a=e.popup.getElement();if(!a)return;const n=a.querySelector('[data-action="edit"]'),t=a.querySelector('[data-action="delete"]');n&&(n.onclick=()=>ze(r)),t&&(t.onclick=()=>Ze(r))}),e.on("mouseover",()=>e.openPopup()),e.on("mouseout",()=>e.closePopup()),e.on("click",()=>{e.openPopup(),Qe({lat:c,lng:u,marker:e})}),M[r]={lat:c,lng:u,isSafeZone:d,marker:(0,o.IG)(e)}}i&&Ce(),l&&O.value&&fe([c,u],pe(),M[r]?.marker,{animate:!0})}function Ae(e,a,n,t){const l=oe(e);return`\n    <div class="custom-popup">\n      <div style="font-weight:600;font-size:14px;margin-bottom:4px;">\n        ${l}\n        ${t?'<span style="color:red;margin-left:5px;">(Safe Zone)</span>':""}\n      </div>\n      <div style="font-size:12px;color:#666;margin-bottom:8px;">\n        Lat: ${Number(a).toFixed(6)}<br/>Lng: ${Number(n).toFixed(6)}\n      </div>\n      <div style="display:flex;gap:6px;flex-wrap:wrap;">\n        <button data-action="edit"\n          class="q-btn q-btn-item non-selectable no-outline q-btn--flat q-btn--rectangle text-primary q-focusable q-hoverable q-btn--dense"\n          style="font-size:11px;padding:4px 8px;min-height:unset;">\n          <span class="q-btn__content text-center col items-center q-anchor--skip justify-center row">\n            <i class="q-icon material-icons" aria-hidden="true" role="img">edit</i>\n            <span class="block q-ml-xs">แก้ไข</span>\n          </span>\n        </button>\n\n        <button data-action="delete"\n          class="q-btn q-btn-item non-selectable no-outline q-btn--flat q-btn--rectangle text-negative q-focusable q-hoverable q-btn--dense"\n          style="font-size:11px;padding:4px 8px;min-height:unset;">\n          <span class="q-btn__content text-center col items-center q-anchor--skip justify-center row">\n            <i class="q-icon material-icons" aria-hidden="true" role="img">delete</i>\n            <span class="block q-ml-xs">ลบ</span>\n          </span>\n        </button>\n      </div>\n    </div>\n  `}function Ce(){if(!O.value)return;const e=Object.values(M);if(0===e.length)return O.value.setView(D.center,D.zoom,{animate:!1}),void(me.value={type:"bounds",payload:null});const a=s().featureGroup(e.map(e=>e.marker)),n=a.getBounds();if(1===e.length){const a=e[0];fe([a.lat,a.lng],pe(),a.marker,{animate:!0})}else be(n,{animate:!0})}async function Ve(){const e=ne(n.value),t=te(r.value),l=te(Q.value);if(!e||!Number.isFinite(t)||!Number.isFinite(l))return void a.notify({color:"negative",message:"กรุณากรอกชื่อสถานที่ และ Latitude/Longitude ให้ครบถ้วน",icon:"warning"});const o={name:e,lat:t,lng:l,isSafeZone:!!W.value};try{await u.api.post("/api/markers",o),Se(o.name,o.lat,o.lng,o.isSafeZone,!0,!0),a.notify({color:"positive",message:`บันทึก "${e}" เรียบร้อยแล้ว`,icon:"check_circle"})}catch(e){console.error("Error saving marker:",e),a.notify({color:"negative",message:"เกิดข้อผิดพลาดในการบันทึกข้อมูล",icon:"error"})}finally{ke()}}function ze(e){const a=ne(e);a&&M[a]&&(E.value=a,I.value=a,P.value=!!M[a]?.isSafeZone,j.value=!0)}async function Re(){const e=ne(E.value),n=ne(I.value),t=!!P.value;if(!n)return void a.notify({color:"warning",message:"กรุณากรอกชื่อสถานที่"});const l=M[e];if(l)if(e!==n||!!l.isSafeZone!==t){a.loading.show({message:"กำลังบันทึกการแก้ไข..."});try{const o={name:n,lat:l.lat,lng:l.lng,isSafeZone:t};await u.api.post("/api/markers",o),e!==n&&(await u.api.delete(`/api/markers/${encodeURIComponent(e)}`),G.value?.removeLayer(l.marker),delete M[e]),Se(o.name,o.lat,o.lng,o.isSafeZone,!1,!0),a.notify({color:"positive",message:"บันทึกการแก้ไขเรียบร้อยแล้ว",icon:"check_circle"}),j.value=!1}catch(e){console.error("Update failed:",e),a.notify({color:"negative",message:"บันทึกไม่สำเร็จ",icon:"error"})}finally{a.loading.hide(),ke()}}else j.value=!1;else j.value=!1}function Ze(e){const n=ne(e);n&&a.dialog({title:"ยืนยันการลบ",message:`คุณต้องการลบตำแหน่ง "${n}" ใช่หรือไม่?`,cancel:!0,persistent:!0,ok:{flat:!0,color:"negative",label:"ลบออก"}}).onOk(async()=>{await Te(n)})}async function Te(e){const n=ne(e);try{await u.api.delete(`/api/markers/${encodeURIComponent(n)}`),M[n]&&(G.value?.removeLayer(M[n].marker),delete M[n]),Ce(),a.notify({color:"positive",message:`ลบ "${n}" เรียบร้อยแล้ว`,icon:"delete"})}catch(e){console.error("Error deleting marker:",e),a.notify({color:"negative",message:"เกิดข้อผิดพลาดในการลบข้อมูล",icon:"error"})}finally{ke()}}function Ne(){n.value="",r.value=null,Q.value=null,W.value=!1,K.value=""}function Qe(e){fe([e.lat,e.lng],pe(),e.marker,{animate:!0})}async function We(){const e=ne(K.value);if(e){B.value=!0;try{const n=await Ke(e);if(n){r.value=Number(n.lat.toFixed(6)),Q.value=Number(n.lng.toFixed(6));const e=a.screen.xs?15:16;fe([n.lat,n.lng],e,null,{animate:!0}),a.notify({color:"positive",message:"พบตำแหน่งแล้ว",icon:"check"})}else a.notify({color:"negative",message:"ไม่พบพิกัดจากที่อยู่นี้",icon:"error"})}catch(e){console.error(e),a.notify({color:"negative",message:"เกิดข้อผิดพลาดในการเชื่อมต่อ",icon:"error"})}finally{B.value=!1,ke()}}else a.notify({color:"warning",message:"กรุณากรอกที่อยู่สำหรับค้นหา",icon:"search"})}async function Ke(e){let a={};try{const e=localStorage.getItem(N);e&&(a=JSON.parse(e)||{})}catch{a={}}if(a[e])return a[e];const n="https://nominatim.openstreetmap.org/search?format=jsonv2&limit=1&q="+encodeURIComponent(e),t=await fetch(n,{headers:{Accept:"application/json"}});if(!t.ok)throw new Error("Geocoding error");const l=await t.json();if(!l||0===l.length)return null;const o=parseFloat(l[0].lat),i=parseFloat(l[0].lon);a[e]={lat:o,lng:i};try{localStorage.setItem(N,JSON.stringify(a))}catch{}return{lat:o,lng:i}}return(0,t.sV)(async()=>{await(0,t.dY)(),await _e(),setTimeout(()=>ke(),200)}),(0,t.xo)(()=>{xe()}),(e,a)=>{const s=(0,t.g2)("q-badge"),c=(0,t.g2)("q-card-section"),u=(0,t.g2)("q-separator"),d=(0,t.g2)("q-resize-observer"),N=(0,t.g2)("q-spinner-gears"),E=(0,t.g2)("q-inner-loading"),O=(0,t.g2)("q-card"),G=(0,t.g2)("q-icon"),M=(0,t.g2)("q-input"),X=(0,t.g2)("q-btn"),D=(0,t.g2)("q-checkbox"),ne=(0,t.g2)("q-space"),te=(0,t.g2)("q-tooltip"),le=(0,t.g2)("q-chip"),oe=(0,t.g2)("q-td"),re=(0,t.g2)("q-card-actions"),ue=(0,t.g2)("q-table"),de=(0,t.g2)("q-dialog"),me=(0,t.g2)("q-page"),pe=(0,t.gN)("close-popup");return(0,t.uX)(),(0,t.Wv)(me,{class:(0,l.C4)(H.value+" bg-grey-2")},{default:(0,t.k6)(()=>[(0,t.Lk)("div",m,[(0,t.Lk)("div",p,[a[19]||(a[19]=(0,t.Lk)("h1",{class:"text-h4 text-center text-weight-bold q-mb-xs text-primary"}," กำหนดสถานที่ปลอดภัย ",-1)),a[20]||(a[20]=(0,t.Lk)("p",{class:"text-subtitle1 text-center text-grey-7 q-mb-lg"}," โรงเรียนวารีเชียงใหม่ (Northern Thailand) ",-1)),(0,t.Lk)("div",g,[(0,t.bF)(O,{class:"my-card map-card"},{default:(0,t.k6)(()=>[(0,t.bF)(c,{class:"q-pb-none"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",v,[(0,t.bF)(s,{color:"primary",class:"q-mr-sm text-subtitle2"},{default:(0,t.k6)(()=>[...a[8]||(a[8]=[(0,t.eW)("1",-1)])]),_:1}),a[9]||(a[9]=(0,t.eW)(" แผนที่ (LeafletJS + OSM) ",-1))]),a[10]||(a[10]=(0,t.Lk)("p",{class:"text-caption text-grey-7 q-ma-none"}," คลิกที่ Marker เพื่อดูรายละเอียด (Popup) ",-1))]),_:1}),(0,t.bF)(u),(0,t.bF)(c,{class:"map-body relative-position"},{default:(0,t.k6)(()=>[(0,t.bF)(d,{onResize:(0,o.R1)(he)},null,8,["onResize"]),(0,t.Lk)("div",{ref_key:"mapEl",ref:$,class:"map-container rounded-borders shadow-1",style:(0,l.Tr)({height:Y.value})},null,4),(0,t.bF)(E,{showing:U.value},{default:(0,t.k6)(()=>[(0,t.bF)(N,{size:"50px",color:"primary"}),a[11]||(a[11]=(0,t.Lk)("div",{class:"text-subtitle2 q-mt-sm"},"กำลังโหลดข้อมูลสถานที่...",-1))]),_:1},8,["showing"])]),_:1})]),_:1}),(0,t.bF)(O,{class:"my-card"},{default:(0,t.k6)(()=>[(0,t.bF)(c,null,{default:(0,t.k6)(()=>[(0,t.Lk)("div",f,[(0,t.bF)(s,{color:"primary",class:"q-mr-sm text-subtitle2"},{default:(0,t.k6)(()=>[...a[12]||(a[12]=[(0,t.eW)("2",-1)])]),_:1}),a[13]||(a[13]=(0,t.eW)(" ฟอร์มบันทึกตำแหน่ง (Marker Form) ",-1))]),(0,t.Lk)("div",b,[(0,t.bF)(M,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),label:"ชื่อสถานที่ / อาคาร",placeholder:"เช่น อาคารที่ 1",outlined:"",dense:J.value,"bg-color":"white",rules:[e=>!!String(e||"").trim()||"กรุณากรอกชื่อสถานที่"]},{prepend:(0,t.k6)(()=>[(0,t.bF)(G,{name:"place"})]),_:1},8,["modelValue","dense","rules"]),(0,t.Lk)("div",y,[(0,t.Lk)("div",k,[(0,t.bF)(M,{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=e=>r.value=e),modelModifiers:{number:!0},type:"number",label:"Latitude",placeholder:"18.xxxx",outlined:"",dense:J.value,"bg-color":"white",step:"0.000001"},null,8,["modelValue","dense"])]),(0,t.Lk)("div",h,[(0,t.bF)(M,{modelValue:Q.value,"onUpdate:modelValue":a[2]||(a[2]=e=>Q.value=e),modelModifiers:{number:!0},type:"number",label:"Longitude",placeholder:"99.xxxx",outlined:"",dense:J.value,"bg-color":"white",step:"0.000001"},null,8,["modelValue","dense"])])]),(0,t.bF)(M,{modelValue:K.value,"onUpdate:modelValue":a[3]||(a[3]=e=>K.value=e),label:"ค้นหาจากชื่อที่อยู่ (Geocoding)",placeholder:"เช่น โรงเรียนวารี",outlined:"",dense:J.value,"bg-color":"white",onKeyup:(0,i.jR)(We,["enter"]),hint:"ใช้บริการ Nominatim (OpenStreetMap)"},{append:(0,t.k6)(()=>[(0,t.bF)(X,{flat:"",round:"",color:"primary",icon:"search",onClick:We,loading:B.value},null,8,["loading"])]),_:1},8,["modelValue","dense"]),(0,t.Lk)("div",x,[(0,t.bF)(D,{modelValue:W.value,"onUpdate:modelValue":a[4]||(a[4]=e=>W.value=e),label:"สถานะ Safe Zone (จุดปลอดภัย)",color:"positive","keep-color":"",dense:J.value},null,8,["modelValue","dense"]),(0,t.bF)(G,{name:"emergency",color:W.value?"red":"grey-4",size:"22px",class:"q-ml-sm"},null,8,["color"])]),(0,t.Lk)("div",w,[(0,t.Lk)("div",q,[(0,t.bF)(X,{unelevated:"",color:"secondary","text-color":"white",icon:"my_location",label:"ค้นหาพิกัด",onClick:We,loading:B.value,class:(0,l.C4)(J.value?"full-width":"")},null,8,["loading","class"])]),(0,t.Lk)("div",F,[(0,t.bF)(X,{unelevated:"",color:"positive",icon:"add_location_alt",label:"เพิ่ม/อัปเดต",onClick:Ve,class:(0,l.C4)(J.value?"full-width":"")},null,8,["class"])]),(0,t.Lk)("div",_,[(0,t.bF)(X,{outline:"",color:"grey-7",label:"ล้างค่า",onClick:Ne,class:(0,l.C4)(J.value?"full-width":"")},null,8,["class"])])])])]),_:1}),(0,t.bF)(u),(0,t.bF)(c,null,{default:(0,t.k6)(()=>[(0,t.Lk)("div",L,[(0,t.Lk)("div",S," รายการ Marker ("+(0,l.v_)(se.value.length)+") ",1),(0,t.bF)(ne),(0,t.bF)(X,{flat:"",round:"",color:"primary",icon:"refresh",size:"sm",onClick:Le,loading:U.value},{default:(0,t.k6)(()=>[(0,t.bF)(te,null,{default:(0,t.k6)(()=>[...a[14]||(a[14]=[(0,t.eW)("รีเฟรชข้อมูล",-1)])]),_:1})]),_:1},8,["loading"])]),(0,t.bF)(ue,{rows:se.value,columns:ce,"visible-columns":ae.value,"row-key":"name",flat:"",bordered:"",dense:J.value,grid:J.value,"hide-header":J.value,pagination:{rowsPerPage:J.value?6:10},class:"bg-white"},(0,t.eX)({_:2},[J.value?void 0:{name:"body-cell-isSafeZone",fn:(0,t.k6)(e=>[(0,t.bF)(oe,{props:e,class:"text-center"},{default:(0,t.k6)(()=>[e.value?((0,t.uX)(),(0,t.Wv)(le,{key:0,color:"negative","text-color":"white",size:"sm",dense:"",icon:"emergency",label:"Safe"})):((0,t.uX)(),(0,t.Wv)(le,{key:1,color:"grey-3","text-color":"grey-8",size:"sm",dense:"",label:"-"}))]),_:2},1032,["props"])]),key:"0"},J.value?void 0:{name:"body-cell-actions",fn:(0,t.k6)(e=>[(0,t.bF)(oe,{props:e,class:"text-right"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",A,[(0,t.bF)(X,{flat:"",round:"",color:"primary",icon:"my_location",size:"sm",onClick:(0,i.D$)(a=>Qe(e.row),["stop"])},{default:(0,t.k6)(()=>[(0,t.bF)(te,null,{default:(0,t.k6)(()=>[...a[15]||(a[15]=[(0,t.eW)("ไปที่ตำแหน่งนี้",-1)])]),_:1})]),_:1},8,["onClick"]),(0,t.bF)(X,{flat:"",round:"",color:"orange",icon:"edit",size:"sm",onClick:(0,i.D$)(a=>ze(e.row.name),["stop"])},{default:(0,t.k6)(()=>[(0,t.bF)(te,null,{default:(0,t.k6)(()=>[...a[16]||(a[16]=[(0,t.eW)("แก้ไขชื่อ/สถานะ",-1)])]),_:1})]),_:1},8,["onClick"]),(0,t.bF)(X,{flat:"",round:"",color:"negative",icon:"delete",size:"sm",onClick:(0,i.D$)(a=>Ze(e.row.name),["stop"])},{default:(0,t.k6)(()=>[(0,t.bF)(te,null,{default:(0,t.k6)(()=>[...a[17]||(a[17]=[(0,t.eW)("ลบ",-1)])]),_:1})]),_:1},8,["onClick"])])]),_:2},1032,["props"])]),key:"1"},J.value?{name:"item",fn:(0,t.k6)(e=>[(0,t.Lk)("div",C,[(0,t.bF)(O,{class:"q-mb-sm"},{default:(0,t.k6)(()=>[(0,t.bF)(c,{class:"q-pb-sm"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",V,[(0,t.Lk)("div",z,[(0,t.Lk)("div",R,(0,l.v_)(e.row.name),1),(0,t.Lk)("div",Z," Lat: "+(0,l.v_)(ie(e.row.lat))+" | Lng: "+(0,l.v_)(ie(e.row.lng)),1)]),(0,t.Lk)("div",T,[e.row.isSafeZone?((0,t.uX)(),(0,t.Wv)(le,{key:0,color:"negative","text-color":"white",dense:"",icon:"emergency",label:"Safe"})):((0,t.uX)(),(0,t.Wv)(le,{key:1,color:"grey-3","text-color":"grey-8",dense:"",label:"-"}))])])]),_:2},1024),(0,t.bF)(u),(0,t.bF)(re,{align:"right",class:"q-pa-sm"},{default:(0,t.k6)(()=>[(0,t.bF)(X,{flat:"",color:"primary",icon:"my_location",label:"ไปที่นี่",onClick:a=>Qe(e.row)},null,8,["onClick"]),(0,t.bF)(X,{flat:"",color:"orange",icon:"edit",label:"แก้ไข",onClick:a=>ze(e.row.name)},null,8,["onClick"]),(0,t.bF)(X,{flat:"",color:"negative",icon:"delete",label:"ลบ",onClick:a=>Ze(e.row.name)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)])]),key:"2"}:void 0]),1032,["rows","visible-columns","dense","grid","hide-header","pagination"])]),_:1})]),_:1})]),(0,t.bF)(de,{modelValue:j.value,"onUpdate:modelValue":a[7]||(a[7]=e=>j.value=e),persistent:""},{default:(0,t.k6)(()=>[(0,t.bF)(O,{style:(0,l.Tr)(ee.value)},{default:(0,t.k6)(()=>[(0,t.bF)(c,{class:"bg-primary text-white q-pa-md"},{default:(0,t.k6)(()=>[...a[18]||(a[18]=[(0,t.Lk)("div",{class:"text-h6 text-weight-bold"},"แก้ไขชื่อสถานที่",-1)])]),_:1}),(0,t.bF)(c,{class:"q-pt-lg q-gutter-y-md"},{default:(0,t.k6)(()=>[(0,t.bF)(M,{modelValue:I.value,"onUpdate:modelValue":a[5]||(a[5]=e=>I.value=e),label:"ชื่อสถานที่ใหม่",outlined:"",dense:J.value,autofocus:"",onKeyup:(0,i.jR)(Re,["enter"]),rules:[e=>!!String(e||"").trim()||"กรุณากรอกชื่อสถานที่"]},null,8,["modelValue","dense","rules"]),(0,t.bF)(D,{modelValue:P.value,"onUpdate:modelValue":a[6]||(a[6]=e=>P.value=e),label:"สถานะ Safe Zone (จุดปลอดภัย)",color:"negative",dense:J.value},null,8,["modelValue","dense"])]),_:1}),(0,t.bF)(re,{align:"right",class:"text-primary q-pb-md q-px-md"},{default:(0,t.k6)(()=>[(0,t.bo)((0,t.bF)(X,{flat:"",label:"ยกเลิก",color:"grey-7"},null,512),[[pe]]),(0,t.bF)(X,{unelevated:"",label:"บันทึกการแก้ไข",color:"primary",onClick:Re})]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"]),a[21]||(a[21]=(0,t.Lk)("div",{class:"text-center q-mt-lg text-caption text-grey"}," Program by Vue.js & Quasar Framework | Leaflet.js | OpenStreetMap ",-1))])])]),_:1},8,["class"])}}};var W=n(2968),K=n(5013),B=n(3341),U=n(222),j=n(8155),E=n(6915),I=n(9993),P=n(8356),$=n(9667),O=n(6067),G=n(3933),M=n(9039),X=n(8349),D=n(5873),J=n(8387),H=n(9183),Y=n(8785),ee=n(1529),ae=n(5034),ne=n(45),te=n(8657),le=n(272),oe=n.n(le);const ie=(0,W.A)(Q,[["__scopeId","data-v-375a8ff5"]]),re=ie;oe()(Q,"components",{QPage:K.A,QCard:B.A,QCardSection:U.A,QBadge:j.A,QSeparator:E.A,QResizeObserver:I.A,QInnerLoading:P.A,QSpinnerGears:$.A,QInput:O.A,QIcon:G.A,QBtn:M.A,QCheckbox:X.A,QSpace:D.A,QTooltip:J.A,QTable:H.A,QTd:Y.A,QChip:ee.A,QCardActions:ae.A,QDialog:ne.A}),oe()(Q,"directives",{ClosePopup:te.A})},6575:(e,a,n)=>{n.d(a,{JH:()=>i,Tg:()=>t,_m:()=>o,po:()=>l});const t=[{name:"อาคาร 1 อาคารอำนวยการ",lat:18.758769,lng:99.014645},{name:"อาคาร 2 อาคารสารสนเทศ",lat:18.758914,lng:99.015257},{name:"อาคาร 3 อาคารประถมศึกษา",lat:18.758361,lng:99.015129},{name:"อาคาร 4 อาคารมัธยมศึกษาตอนต้น",lat:18.757983,lng:99.015512},{name:"อาคาร 5 อาคารอนุบาล สระว่ายน้ำ โรงอาหาร",lat:18.758168,lng:99.015763},{name:"อาคาร 6 อาคารพลศึกษา ห้องสภานักเรียน",lat:18.757394,lng:99.015381},{name:"อาคาร 7 อาคารมัธยมศึกษาตอนปลาย ห้องสมุด",lat:18.75759,lng:99.015905},{name:"สนามฟุตซอล (Futsal)",lat:18.757955,lng:99.015097},{name:"สนามหญ้าจริง (Safe Zone)",lat:18.757826,lng:99.014679},{name:"สนามบาสเก็ดบอล",lat:18.757833,lng:99.015761}],l=[{nameA:"อาคาร 1 อาคารอำนวยการ",nameB:"อาคาร 3 อาคารประถมศึกษา",distance:50,time:2},{nameA:"อาคาร 3 อาคารประถมศึกษา",nameB:"สนามฟุตซอล (Futsal)",distance:40,time:1},{nameA:"สนามฟุตซอล (Futsal)",nameB:"สนามหญ้าจริง (Safe Zone)",distance:30,time:1},{nameA:"อาคาร 2 อาคารสารสนเทศ",nameB:"สนามฟุตซอล (Futsal)",distance:60,time:2},{nameA:"อาคาร 1 อาคารอำนวยการ",nameB:"อาคาร 2 อาคารสารสนเทศ",distance:15,time:1},{nameA:"อาคาร 2 อาคารสารสนเทศ",nameB:"อาคาร 3 อาคารประถมศึกษา",distance:45,time:2},{nameA:"อาคาร 4 อาคารมัธยมศึกษาตอนต้น",nameB:"สนามฟุตซอล (Futsal)",distance:25,time:1},{nameA:"อาคาร 5 อาคารอนุบาล สระว่ายน้ำ โรงอาหาร",nameB:"อาคาร 4 อาคารมัธยมศึกษาตอนต้น",distance:35,time:1},{nameA:"อาคาร 6 อาคารพลศึกษา ห้องสภานักเรียน",nameB:"สนามหญ้าจริง (Safe Zone)",distance:55,time:2},{nameA:"อาคาร 7 อาคารมัธยมศึกษาตอนปลาย ห้องสมุด",nameB:"สนามบาสเก็ดบอล",distance:40,time:2}],o=[[18.759325,99.014238],[18.759477,99.016395],[18.757065,99.016556],[18.756913,99.014388]],i=[{name:"Gate 1 (ทางเข้าหลัก)",lat:18.7588,lng:99.01445},{name:"Gate 2 (ทางเข้าอนุบาล)",lat:18.7583,lng:99.016}]}}]);